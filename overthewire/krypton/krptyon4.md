# CTF Writeup - **OverTheWire Krypton4 - Krypton5**

**Author**: spiketyson 

---

## Challenge Details

- **Challenge Name:** Krypton4 - Krypton5
- **Category:** Linux
- **Difficulty Level:** Easy
- **Date:** 28-11-2024

---

## Summary

This challenge is the introductory level4 for the Krypton series on OverTheWire, focusing on basic cryptography skills.  This level is a VigenÃ¨re Cipher. You have intercepted two longer, english language messages (American English). You also have a key piece of information. You know the key length! For this exercise, the key length is 6. The password to level five is in the usual place, encrypted with the 6 letter key.

---

## Approach

Since this is an introductory challenge, I planned to use `dcode.fr` for decoding the cipher string.
---

## Solution Walkthrough

Lets log into the server as `krypton4` to have the necessary permissions. 

```bash
ssh krypton4@krypton.labs.overthewire.org -p 2231
# Password: BRUTE
```

After logging in, lets move to the `/krypton/krypton4` directory and explore it.

```bash
cd /krypton/krypton4/
ls -la
# total 28
# drwxr-xr-x 2 root     root     4096 Sep 19 07:10 .
# drwxr-xr-x 9 root     root     4096 Sep 19 07:10 ..
# -rw-r----- 1 krypton4 krypton4 1740 Sep 19 07:10 found1
# -rw-r----- 1 krypton4 krypton4 2943 Sep 19 07:10 found2
# -rw-r----- 1 krypton4 krypton4  287 Sep 19 07:10 HINT
# -rw-r----- 1 krypton4 krypton4   10 Sep 19 07:10 krypton5
# -rw-r----- 1 krypton4 krypton4 1385 Sep 19 07:10 README
```

Here we have 5 files. `krypton4` has the password for the next level. `found1`,`found2` are the files which has the cipher text which was encrypted with the same encryption mechanism. `HINT1` files gives you a clue to do a character frequency of the `found` files. Since Its vigenere cipher, It would be tedious to do frequency analysis and then fing the key lenght using kasaki's test. But here we know the key length is 6 and there is 2 files with encrypted data. Lets go to `dcode.fr/vigenere-cipher` and then lets try decrypting the `found1` file

```bash
# CIPHERTEXT = YYICS JIZIB AGYYX RIEWV IXAFN JOOVQ QVHDL CRKLB SSLYX RIQYI IOXQT WXRIC RVVKP BHZXI YLYZP DLCDI IKGFJ UXRIP TFQGL CWVXR IEZRV NMYSF JDLCL RXOWJ NMINX FNJSP JGHVV ERJTT OOHRM VMBWN JTXKG JJJXY TSYKL OQZFT OSRFN JKBIY YSSHE LIKLO RFJGS VMRJC CYTCS VHDLC LRXOJ MWFYB JPNVR NWUMZ GRVMF UPOEB XKSDL CBZGU IBBZX MLMKK LOACX KECOC IUSBS RMPXR IPJZW XSPTR HKRQB VVOHR MVKEE PIZEX SDYYI QERJJ RYSLJ VZOVU NJLOW RTXSD LYYNE ILMBK LORYW VAOXM KZRNL CWZRA YGWVH DLCLZ VVXFF KASPJ GVIKW WWVTV MCIKL OQYSW SBAFJ EWRII SFACC MZRVO MLYYI MSSSK VISDY YIGML PZICW FJNMV PDNEH ISSFE HWEIJ PSEEJ QYIBW JFMIC TCWYE ZWLTK WKMBY YICGY WVGBS UKFVG IKJRR DSBJJ XBSWM VVYLR MRXSW BNWJO VCSKW KMBYY IQYYW UMKRM KKLOK YYVWX SMSVL KWCAV VNIQY ISIIB MVVLI DTIIC SGSRX EVYQC CDLMZ XLDWF JNSEP BRROO WJFMI CSDDF YKWQM VLKWM KKLOV CXKFE XRFBI MEPJW SBWFJ ZWGMA PVHKR BKZIB GCFEH WEWSF XKPJT NCYYR TUICX PTPLO VIJVT DSRMV AOWRB YIBIR MVWER QJKWK RBDFY MELSF XPEGQ KSPML IYIBX FJPXR ELPVH RMKFE HLEBJ YMWKM TUFII YSUXE VLJUX YAYWU XRIUJ JXGEJ PZRQS TJIJS IJIJS PWMKK KBEQX USDXC IYIBI YSUXR IPJNM DLBFZ WSIQF EHLYR YVVMY NXUSB SRMPW DMJQN SBIRM VTBIR YPWSP IIIIC WQMVL KHNZK SXMLY YIZEJ FTILY RSFAD SFJIW EVNWZ WOWFJ WSERB NKAKW LTCSX KCWXV OILGL XZYPJ NLSXC YYIBM ZGFRK VMZEH DSRTJ ROGIM RHKPQ TCSCX GYJKB ICSTS VSPFE HGEQF JARMR JRWNS PTKLI WBWVW CXFJV QOVYQ UGSXW BRWCS MSCIP XDFIF OLGSU ECXFJ PENZY STINX FJXVY YLISI MEKJI SEKFJ IEXHF NCPSI PKFVD LCWVA OVCSF JKVKX ESBLM ZJICM LYYMC GMZEX BCMKK LOACX KEXHR MVKBS SSUAK WSSKM VPCIZ RDLCF WXOVL TFRDL CXLRC LMSVL YXGSK LOMPK RGOWD TIXRI PJNIB ILTKV OIQYF SPJCW KLOQQ MRHOW MYYED FCKFV ORGLY XNSPT KLIEL IKSDS YSUXR IJNFR GIPJK MBIBF EHVEW IFAXY NTEXR IEWRW CELIW IVPYX CIOTU NKLDL CBFSN QYSRR NXFJJ GKVCH ISGOC JGMXK UFKGR
# Key length = 6
# --> Decode
# Key = FREKEY
# PLAINTEXT = THESOLDIERWITHTHEGREENWHISKERSLEDTHEMTHROUGHTHESTREETSOFTHEEMERALDCITYUNTILTHEYREACHEDTHEROOMWHERETHEGUARDIANOFTHEGATESLIVEDTHISOFFICERUNLOCKEDTHEIRSPECTACLESTOPUTTHEMBACKINHISGREATBOXANDTHENHEPOLITELYOPENEDTHEGATEFOROURFRIENDSWHICHROADLEADSTOTHEWICKEDWITCHOFTHEWESTASKEDDOROTHYTHEREISNOROADANSWEREDTHEGUARDIANOFTHEGATESNOONEEVERWISHESTOGOTHATWAYHOWTHENAREWETOFINDHERINQUIREDTHEGIRLTHATWILLBEEASYREPLIEDTHEMANFORWHENSHEKNOWSYOUAREINTHECOUNTRYOFTHEWINKIESSHEWILLFINDYOUANDMAKEYOUALLHERSLAVESPERHAPSNOTSAIDTHESCARECROWFORWEMEANTODESTROYHEROHTHATISDIFFERENTSAIDTHEGUARDIANOFTHEGATESNOONEHASEVERDESTROYEDHERBEFORESOINATURALLYTHOUGHTSHEWOULDMAKESLAVESOFYOUASSHEHASOFTHERESTBUTTAKECAREFORSHEISWICKEDANDFIERCEANDMAYNOTALLOWYOUTODESTROYHERKEEPTOTHEWESTWHERETHESUNSETSANDYOUCANNOTFAILTOFINDHERTHEYTHANKEDHIMANDBADEHIMGOODBYEANDTURNEDTOWARDTHEWESTWALKINGOVERFIELDSOFSOFTGRASSDOTTEDHEREANDTHEREWITHDAISIESANDBUTTERCUPSDOROTHYSTILLWORETHEPRETTYSILKDRESSSHEHADPUTONINTHEPALACEBUTNOWTOHERSURPRISESHEFOUNDITWASNOLON
```

Now that we have found the key `FREKEY` we can use it to decrypt the `krypton5` password.

```bash
# CIPHERTEXT = HCIKV RJOX
# Key Length = 6
# Key = FREKEY
# PLAINTEXT = CLEAR TEXT
```

---

## Flag

**Flag:** CLEAR TEXT

---

## Lessons Learned

It was a good learning for using `dcode.fr` to decode monoalphabetic substitution cipher.
